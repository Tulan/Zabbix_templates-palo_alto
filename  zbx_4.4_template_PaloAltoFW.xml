<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-07-24T08:19:26Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Palo Alto Firewall</template>
            <name>Template Palo Alto Firewall</name>
            <templates>
                <template>
                    <name>Template Module Interfaces SNMPv2</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Processor 1 Load (mgmt)</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.2.1.25.3.3.1.2.1</snmp_oid>
                    <key>hrProcessorLoad1</key>
                    <history>30d</history>
                    <units>%</units>
                    <port>161</port>
                    <description>The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(15m)}&gt;95</expression>
                            <name>CPU utilization (MP) on {HOST.HOST} is over 95% for 15 min</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor 2 Load (data)</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.2.1.25.3.3.1.2.2</snmp_oid>
                    <key>hrProcessorLoad2</key>
                    <history>30d</history>
                    <units>%</units>
                    <port>161</port>
                    <description>The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{min(15m)}&gt;95</expression>
                            <name>CPU utilization (DP) on {HOST.HOST} is over 95% for 15 min</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ICMP Check</name>
                    <type>SIMPLE</type>
                    <key>icmpping[,2]</key>
                    <history>30d</history>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>BOOL_TO_DECIMAL</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(#1)}=0 and {last(#2)}=0</expression>
                            <name>{HOST.HOST} is down!</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Chassis type</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.2.1.0</snmp_oid>
                    <key>panChassisType</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Chassis type for this Palo Alto device.</description>
                    <inventory_link>MODEL</inventory_link>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total active sessions</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.3.3.0</snmp_oid>
                    <key>panSessionActive</key>
                    <history>30d</history>
                    <port>161</port>
                    <description>Total number of active sessions.</description>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Total number of sessions</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.3.2.0</snmp_oid>
                    <key>panSessionMax</key>
                    <delay>1d</delay>
                    <history>7d</history>
                    <port>161</port>
                    <description>Total number of sessions supported.</description>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>App-ID Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.7.0</snmp_oid>
                    <key>panSysAppVersion</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Currently installed application definition version. If no application definition is found, 0 is returned.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>App-ID version has changed to {ITEM.VALUE1}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Global Protect Client Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.15.0</snmp_oid>
                    <key>panSysGlobalProtectClientVersion</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Currently installed global-protect client package version. If package is not installed, 0.0.0 is returned.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>Global Protect Client Version has changed to {ITEM.VALUE}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>HA Mode</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.13.0</snmp_oid>
                    <key>panSysHAMode</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Current high-availability mode (disabled, active-passive, or active-active).</description>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>HA Peer State</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.12.0</snmp_oid>
                    <key>panSysHAPeerState</key>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Current peer high-availability state.</description>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>HA State</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.11.0</snmp_oid>
                    <key>panSysHAState</key>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Current high-availability state.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>{HOST.HOST} switched to {ITEM.VALUE} state in HA cluster</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>HW Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.2.0</snmp_oid>
                    <key>panSysHwVersion</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Hardware version of the unit.</description>
                    <inventory_link>HARDWARE</inventory_link>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Serial Number</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.3.0</snmp_oid>
                    <key>panSysSerialNumber</key>
                    <delay>1d</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>The serial number of the unit. If not available, an empty string is returned.</description>
                    <inventory_link>SERIALNO_A</inventory_link>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1 and {strlen()}&gt;0</expression>
                            <name>Device has been replaced (new serial number received)</name>
                            <priority>INFO</priority>
                            <description>Last value: {ITEM.LASTVALUE1}.&#13;
Device serial number has changed. Ack to close</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>PAN-OS Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.1.0</snmp_oid>
                    <key>panSysSwVersion</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Full software version. The first two components of the full version are the major and minor versions. The third component indicates the maintenance release number and the fourth, the build number.</description>
                    <inventory_link>OS</inventory_link>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>PAN-OS version has changed to {ITEM.VALUE}</name>
                            <priority>INFO</priority>
                            <description>Operating system on a PA firewall has been upgraded or downgraded</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Threat Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.9.0</snmp_oid>
                    <key>panSysThreatVersion</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Currently installed threat definition version. If no threat definition is found, 0 is returned.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>Threat version has changed to {ITEM.VALUE}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>URL Filtering Version</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.10.0</snmp_oid>
                    <key>panSysUrlFilteringVersion</key>
                    <delay>30m</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>Currently installed URL filtering version. If no URL filtering is installed, 0 is returned.</description>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>URL Filtering Version has changed to {ITEM.VALUE}</name>
                            <status>DISABLED</status>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System Description</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.2.1.1.1.0</snmp_oid>
                    <key>sysDescr</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>A textual description of the entity.  This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.  It is mandatory that this only contain printable ASCII characters.</description>
                    <inventory_link>TYPE</inventory_link>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>System Name</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>sysName</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <port>161</port>
                    <description>An administratively-assigned name for this managed node.  By convention, this is the node's fully-qualified domain name.</description>
                    <inventory_link>NAME</inventory_link>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}=1</expression>
                            <name>Hostname has changed to {ITEM.VALUE}</name>
                            <priority>INFO</priority>
                            <description>Device hostname on a PA firewall has been changed</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System Uptime</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.25.1.1.0</snmp_oid>
                    <key>sysUpTime</key>
                    <history>30d</history>
                    <units>uptime</units>
                    <port>161</port>
                    <description>The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>.01</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{change(0)}&lt;0</expression>
                            <name>{HOST.HOST} has just been restarted</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <delay>60</delay>
                    <history>7d</history>
                    <trends>0d</trends>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <request_method>POST</request_method>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>$1 Discovery</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.47.1.1.1.1.2]</snmp_oid>
                    <key>entPhysicalDescr[FAN]</key>
                    <delay>3600</delay>
                    <port>161</port>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>Fan</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>A textual description of physical entity. This object should contain a string that identifies the manufacturer's name for the physical entity, and should be set to a distinct value for each version or model of the physical entity.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Operational status of $1</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.99.1.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>entPhySensorOperStatus[{#SNMPVALUE},FAN]</key>
                            <delay>300</delay>
                            <port>161</port>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=3</expression>
                                    <name>{#SNMPVALUE} is nonoperational</name>
                                    <priority>HIGH</priority>
                                    <description>Trigger for fan operational status</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#SNMPVALUE}</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>entPhySensorValue[{#SNMPINDEX},FAN]</key>
                            <delay>60</delay>
                            <units>rpm</units>
                            <port>161</port>
                            <description>ENTITY-SENSOR-MIB::entPhySensorValue&amp;#13;&#13;
&amp;#13;&#13;
The most recent measurement obtained by the agent for this sensor.</description>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
                <discovery_rule>
                    <name>$1 Discovery</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.47.1.1.1.1.2]</snmp_oid>
                    <key>entPhysicalDescr[TEMPERATURE]</key>
                    <delay>3600</delay>
                    <port>161</port>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>Temperature</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>A textual description of physical entity. This object should contain a string that identifies the manufacturer's name for the physical entity, and should be set to a distinct value for each version or model of the physical entity.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Operational status of {#SNMPVALUE}</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.99.1.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>entPhySensorOperStatus[{#SNMPINDEX},TEMPERATURE]</key>
                            <delay>300</delay>
                            <port>161</port>
                            <description>Discovery of alarm status at temperature sensor</description>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>{#SNMPVALUE}</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>entPhySensorValue[{#SNMPINDEX},TEMPERATURE]</key>
                            <delay>60</delay>
                            <units>°C</units>
                            <port>161</port>
                            <description>Temperature item discovery</description>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Template Palo Alto Firewall:entPhySensorValue[{#SNMPINDEX},TEMPERATURE].last()}&gt;50 and {Template Palo Alto Firewall:entPhySensorOperStatus[{#SNMPINDEX},TEMPERATURE].last()}=3</expression>
                            <name>{#SNMPVALUE} is {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Temperature: {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template Palo Alto Firewall</host>
                                        <key>entPhySensorValue[{#SNMPINDEX},TEMPERATURE]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
    <graphs>
        <graph>
            <name>CPU load graph</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Palo Alto Firewall</host>
                        <key>hrProcessorLoad1</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template Palo Alto Firewall</host>
                        <key>hrProcessorLoad2</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Sessions load graph</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template Palo Alto Firewall</host>
                        <key>panSessionActive</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>DASHED_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Template Palo Alto Firewall</host>
                        <key>panSessionMax</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>zabbix.host.available</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>not available</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>available</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
